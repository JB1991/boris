<div class="wrapper"
     [class]="isCollapsed ? '' : 'border'">
    <!-- desktop -->
    <div [class]="isCollapsed ? 'd-none d-lg-block' : 'd-none d-xxl-block'">
        <div class="nav-scroller bg-white shadow-sm border-top">
            <nav class="nav nav-underline d-flex justify-content-between p-0">
                <div class="nav">
                    <div class="btn-group d-flex">
                        <div class="btn-group"
                             role="group"
                             dropdown>
                            <button id="button-stichtage-1"
                                    dropdownToggle
                                    type="button"
                                    class="btn btn-block dropdown-toggle"
                                    aria-controls="dropdown-stichtage-1"
                                    aria-haspopup="true">
                                <span i18n>Stichtag</span>: {{stichtag | date}} <span class="caret"
                                      aria-hidden="true"></span>
                            </button>
                            <div id="dropdown-stichtage-1"
                                 *dropdownMenu
                                 class="dropdown-menu"
                                 role="menu"
                                 aria-labelledby="button-stichtage-1">
                                <button type="button"
                                        role="menuitem"
                                        class="dropdown-item"
                                        *ngFor="let stag of bodenrichtwertService.STICHTAGE"
                                        (click)="onStichtagChange(stag)">
                                    {{stag | date}}
                                </button>
                            </div>
                        </div>
                        <div class="btn-group"
                             role="group"
                             dropdown>
                            <button id="button-teilmarkt-1"
                                    dropdownToggle
                                    type="button"
                                    class="btn btn-block dropdown-toggle"
                                    aria-controls="dropdown-teilmarkt-1"
                                    aria-haspopup="true">
                                <span i18n>Teilmarkt</span>: {{teilmarkt.viewValue}} <span class="caret"
                                      aria-hidden="true"></span>
                            </button>
                            <div id="dropdown-teilmarkt-1"
                                 *dropdownMenu
                                 class="dropdown-menu"
                                 role="menu"
                                 aria-labelledby="button-teilmarkt-1">
                                <button type="button"
                                        role="menuitem"
                                        class="dropdown-item"
                                        *ngFor="let tm of bodenrichtwertService.TEILMAERKTE"
                                        (click)="onTeilmarktChange(tm)">
                                    <svg width="0.75em"
                                         height="0.75em"
                                         viewBox="0 0 16 16"
                                         class="bi bi-circle-fill"
                                         [attr.fill]="tm.color"
                                         xmlns="http://www.w3.org/2000/svg"
                                         focusable="false"
                                         aria-hidden="true">
                                        <circle cx="8"
                                                cy="8"
                                                r="8" />
                                    </svg>
                                    {{tm.viewValue}}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="nav px-auto w-100 max-search-width"
                     style="position: relative;">
                    <power-geosearch [adresse]="adresse"
                                     (selectResult)="onSearchSelect($event)"></power-geosearch>
                </div>
                <div class="nav">
                    <div class="btn-group"
                         role="group"
                         dropdown>
                        <button class="btn btn-block dropdown-toggle nav-link"
                                type="button"
                                [ngClass]="{'active' : functionsActive}"
                                dropdownToggle
                                id="dropdownMenuButton"
                                (click)="functionsActive = !functionsActive"
                                aria-haspopup="true"
                                aria-expanded="false">
                            <svg xmlns="http://www.w3.org/2000/svg"
                                 width="20px"
                                 height="20px"
                                 fill="currentColor"
                                 class="bi bi-filter-right"
                                 viewBox="0 0 16 16"
                                 focusable="false"
                                 aria-hidden="true">
                                <path
                                      d="M14 10.5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0 0 1h3a.5.5 0 0 0 .5-.5zm0-3a.5.5 0 0 0-.5-.5h-7a.5.5 0 0 0 0 1h7a.5.5 0 0 0 .5-.5zm0-3a.5.5 0 0 0-.5-.5h-11a.5.5 0 0 0 0 1h11a.5.5 0 0 0 .5-.5z" />
                            </svg> <span class="caret"
                                  aria-hidden="true"></span>
                        </button>
                        <div class="dropdown-menu dropdown-menu-right"
                             *dropdownMenu
                             role="menu">
                            <button class="btn dropdown-item nav-link py-1 text-center"
                                    type="button"
                                    role="menuitem"
                                    (click)="flurstueckssearch.modal.open(flurstueckssearch.title)"
                                    alt="Flurstückssuche"
                                    title="Flurstückssuche"
                                    i18n-alt
                                    i18n-title>
                                <svg width="20px"
                                     height="20px"
                                     viewBox="0 0 16 16"
                                     class="bi bi-bounding-box-circles"
                                     fill="currentColor"
                                     xmlns="http://www.w3.org/2000/svg"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path fill-rule="evenodd"
                                          d="M2 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zM0 2a2 2 0 0 1 3.937-.5h8.126A2 2 0 1 1 14.5 3.937v8.126a2 2 0 1 1-2.437 2.437H3.937A2 2 0 1 1 1.5 12.063V3.937A2 2 0 0 1 0 2zm2.5 1.937v8.126c.703.18 1.256.734 1.437 1.437h8.126a2.004 2.004 0 0 1 1.437-1.437V3.937A2.004 2.004 0 0 1 12.063 2.5H3.937A2.004 2.004 0 0 1 2.5 3.937zM14 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zM2 13a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm12 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z" />
                                </svg>
                            </button>
                            <button class="btn dropdown-item nav-link py-1 text-center"
                                    type="button"
                                    role="menuitem"
                                    (click)="enableLocationTracking()"
                                    alt="Eigenen Standort anzeigen"
                                    title="Eigenen Standort anzeigen"
                                    i18n-alt
                                    i18n-title>
                                <svg width="20px"
                                     height="20px"
                                     viewBox="0 0 16 16"
                                     class="bi bi-geo-fill"
                                     fill="currentColor"
                                     xmlns="http://www.w3.org/2000/svg"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path fill-rule="evenodd"
                                          d="M4 4a4 4 0 1 1 4.5 3.969V13.5a.5.5 0 0 1-1 0V7.97A4 4 0 0 1 4 3.999zm2.493 8.574a.5.5 0 0 1-.411.575c-.712.118-1.28.295-1.655.493a1.319 1.319 0 0 0-.37.265.301.301 0 0 0-.057.09V14l.002.008a.147.147 0 0 0 .016.033.617.617 0 0 0 .145.15c.165.13.435.27.813.395.751.25 1.82.414 3.024.414s2.273-.163 3.024-.414c.378-.126.648-.265.813-.395a.619.619 0 0 0 .146-.15.148.148 0 0 0 .015-.033L12 14v-.004a.301.301 0 0 0-.057-.09 1.318 1.318 0 0 0-.37-.264c-.376-.198-.943-.375-1.655-.493a.5.5 0 1 1 .164-.986c.77.127 1.452.328 1.957.594C12.5 13 13 13.4 13 14c0 .426-.26.752-.544.977-.29.228-.68.413-1.116.558-.878.293-2.059.465-3.34.465-1.281 0-2.462-.172-3.34-.465-.436-.145-.826-.33-1.116-.558C3.26 14.752 3 14.426 3 14c0-.599.5-1 .961-1.243.505-.266 1.187-.467 1.957-.594a.5.5 0 0 1 .575.411z" />
                                </svg>
                            </button>
                            <button class="btn dropdown-item nav-link py-1 text-center"
                                    [ngClass]="{'active': threeDActive}"
                                    type="button"
                                    role="menuitem"
                                    (click)="toggle3dView()"
                                    alt="3D aktivieren/deaktivieren"
                                    title="3D aktivieren/deaktivieren"
                                    i18n-alt
                                    i18n-title>
                                <svg width="20px"
                                     height="20px"
                                     viewBox="0 0 16 16"
                                     class="bi bi-building"
                                     fill="currentColor"
                                     xmlns="http://www.w3.org/2000/svg"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path fill-rule="evenodd"
                                          d="M14.763.075A.5.5 0 0 1 15 .5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V14h-1v1.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V10a.5.5 0 0 1 .342-.474L6 7.64V4.5a.5.5 0 0 1 .276-.447l8-4a.5.5 0 0 1 .487.022zM6 8.694L1 10.36V15h5V8.694zM7 15h2v-1.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5V15h2V1.309l-7 3.5V15z" />
                                    <path
                                          d="M2 11h1v1H2v-1zm2 0h1v1H4v-1zm-2 2h1v1H2v-1zm2 0h1v1H4v-1zm4-4h1v1H8V9zm2 0h1v1h-1V9zm-2 2h1v1H8v-1zm2 0h1v1h-1v-1zm2-2h1v1h-1V9zm0 2h1v1h-1v-1zM8 7h1v1H8V7zm2 0h1v1h-1V7zm2 0h1v1h-1V7zM8 5h1v1H8V5zm2 0h1v1h-1V5zm2 0h1v1h-1V5zm0-2h1v1h-1V3z" />
                                </svg>
                            </button>
                            <button *ngIf="marker.getLngLat() && marker.getLngLat().lat != 0"
                                    type="button"
                                    role="menuitem"
                                    class="btn dropdown-item nav-link py-1 text-center"
                                    alt="Markierung fokussieren"
                                    title="Markierung fokussieren"
                                    (click)="flyTo(marker.getLngLat().lat, marker.getLngLat().lng, $event.type)"
                                    i18n-alt
                                    i18n-title>
                                <svg xmlns="http://www.w3.org/2000/svg"
                                     width="20px"
                                     height="20px"
                                     fill="currentColor"
                                     class="bi bi-zoom-in"
                                     viewBox="0 0 16 16"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path fill-rule="evenodd"
                                          d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z" />
                                    <path
                                          d="M10.344 11.742c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1 6.538 6.538 0 0 1-1.398 1.4z" />
                                    <path fill-rule="evenodd"
                                          d="M6.5 3a.5.5 0 0 1 .5.5V6h2.5a.5.5 0 0 1 0 1H7v2.5a.5.5 0 0 1-1 0V7H3.5a.5.5 0 0 1 0-1H6V3.5a.5.5 0 0 1 .5-.5z" />
                                </svg>
                            </button>
                            <button class="btn dropdown-item nav-link py-1 text-center"
                                    type="button"
                                    role="menuitem"
                                    (click)="resetMap()"
                                    alt="Karte zurücksetzen"
                                    title="Karte zurücksetzen"
                                    aria-label="Karte und Adresseingabe zurücksetzen"
                                    i18n-alt
                                    i18n-title>
                                <svg width="20px"
                                     height="20px"
                                     viewBox="0 0 16 16"
                                     class="bi bi-globe"
                                     fill="currentColor"
                                     xmlns="http://www.w3.org/2000/svg"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path fill-rule="evenodd"
                                          d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm7.5-6.923c-.67.204-1.335.82-1.887 1.855A7.97 7.97 0 0 0 5.145 4H7.5V1.077zM4.09 4H2.255a7.025 7.025 0 0 1 3.072-2.472 6.7 6.7 0 0 0-.597.933c-.247.464-.462.98-.64 1.539zm-.582 3.5h-2.49c.062-.89.291-1.733.656-2.5H3.82a13.652 13.652 0 0 0-.312 2.5zM4.847 5H7.5v2.5H4.51A12.5 12.5 0 0 1 4.846 5zM8.5 5v2.5h2.99a12.495 12.495 0 0 0-.337-2.5H8.5zM4.51 8.5H7.5V11H4.847a12.5 12.5 0 0 1-.338-2.5zm3.99 0V11h2.653c.187-.765.306-1.608.338-2.5H8.5zM5.145 12H7.5v2.923c-.67-.204-1.335-.82-1.887-1.855A7.97 7.97 0 0 1 5.145 12zm.182 2.472a6.696 6.696 0 0 1-.597-.933A9.268 9.268 0 0 1 4.09 12H2.255a7.024 7.024 0 0 0 3.072 2.472zM3.82 11H1.674a6.958 6.958 0 0 1-.656-2.5h2.49c.03.877.138 1.718.312 2.5zm6.853 3.472A7.024 7.024 0 0 0 13.745 12H11.91a9.27 9.27 0 0 1-.64 1.539 6.688 6.688 0 0 1-.597.933zM8.5 12h2.355a7.967 7.967 0 0 1-.468 1.068c-.552 1.035-1.218 1.65-1.887 1.855V12zm3.68-1h2.146c.365-.767.594-1.61.656-2.5h-2.49a13.65 13.65 0 0 1-.312 2.5zm2.802-3.5h-2.49A13.65 13.65 0 0 0 12.18 5h2.146c.365.767.594 1.61.656 2.5zM11.27 2.461c.247.464.462.98.64 1.539h1.835a7.024 7.024 0 0 0-3.072-2.472c.218.284.418.598.597.933zM10.855 4H8.5V1.077c.67.204 1.335.82 1.887 1.855.173.324.33.682.468 1.068z" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </nav>
        </div>
    </div>

    <!-- mobile -->
    <div [class]="isCollapsed ? 'd-lg-none' : 'd-xxl-none'">
        <div class="nav-scroller bg-white shadow-sm border-top">
            <nav class="nav nav-underline d-flex justify-content-between p-0">
                <div class="nav mr-auto">
                    <button class="nav-link btn"
                            [ngClass]="{'active': filterActive}"
                            type="button"
                            (click)="filterActive = !filterActive"
                            alt="Filtern"
                            title="Filtern"
                            i18n-alt
                            i18n-title>
                        <svg width="20px"
                             height="20px"
                             viewBox="0 0 16 16"
                             class="bi bi-filter"
                             fill="currentColor"
                             xmlns="http://www.w3.org/2000/svg"
                             focusable="false"
                             aria-hidden="true">
                            <path fill-rule="evenodd"
                                  d="M6 10.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5z" />
                        </svg>
                    </button>
                </div>
                <div class="nav ml-auto">
                    <button class="nav-link btn"
                            [ngClass]="{'active': searchActive}"
                            type="button"
                            (click)="searchActive = !searchActive"
                            alt="Suche"
                            title="Suche"
                            i18n-alt
                            i18n-title>
                        <svg width="20px"
                             height="20px"
                             viewBox="0 0 16 16"
                             class="bi bi-search"
                             fill="currentColor"
                             xmlns="http://www.w3.org/2000/svg"
                             focusable="false"
                             aria-hidden="true">
                            <path fill-rule="evenodd"
                                  d="M10.442 10.442a1 1 0 0 1 1.415 0l3.85 3.85a1 1 0 0 1-1.414 1.415l-3.85-3.85a1 1 0 0 1 0-1.415z" />
                            <path fill-rule="evenodd"
                                  d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z" />
                        </svg>
                    </button>
                </div>
                <div class="nav">
                    <div class="btn-group d-flex">
                        <div class="btn-group"
                             role="group"
                             dropdown>
                            <button class="btn btn-block nav-link dropdown-toggle"
                                    [ngClass]="{'active': functionsActive}"
                                    type="button"
                                    dropdownToggle
                                    (click)="functionsActive = !functionsActive"
                                    aria-haspopup="true"
                                    aria-expanded="false">
                                <svg xmlns="http://www.w3.org/2000/svg"
                                     width="20px"
                                     height="20px"
                                     fill="currentColor"
                                     class="bi bi-filter-right"
                                     viewBox="0 0 16 16"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path
                                          d="M14 10.5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0 0 1h3a.5.5 0 0 0 .5-.5zm0-3a.5.5 0 0 0-.5-.5h-7a.5.5 0 0 0 0 1h7a.5.5 0 0 0 .5-.5zm0-3a.5.5 0 0 0-.5-.5h-11a.5.5 0 0 0 0 1h11a.5.5 0 0 0 .5-.5z" />
                                </svg> <span class="caret"
                                      aria-hidden="true"></span>
                            </button>
                            <div *dropdownMenu
                                 class="dropdown-menu dropdown-menu-right"
                                 role="menu">
                                <button class="btn nav-link dropdown-item py-1 text-center"
                                        role="menuitem"
                                        type="button"
                                        (click)="flurstueckssearch.modal.open(flurstueckssearch.title)"
                                        alt="Flurstückssuche"
                                        title="Flurstückssuche"
                                        i18n-alt
                                        i18n-title>
                                    <svg width="20px"
                                         height="20px"
                                         viewBox="0 0 16 16"
                                         class="bi bi-bounding-box-circles"
                                         fill="currentColor"
                                         xmlns="http://www.w3.org/2000/svg"
                                         focusable="false"
                                         aria-hidden="true">
                                        <path fill-rule="evenodd"
                                              d="M2 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zM0 2a2 2 0 0 1 3.937-.5h8.126A2 2 0 1 1 14.5 3.937v8.126a2 2 0 1 1-2.437 2.437H3.937A2 2 0 1 1 1.5 12.063V3.937A2 2 0 0 1 0 2zm2.5 1.937v8.126c.703.18 1.256.734 1.437 1.437h8.126a2.004 2.004 0 0 1 1.437-1.437V3.937A2.004 2.004 0 0 1 12.063 2.5H3.937A2.004 2.004 0 0 1 2.5 3.937zM14 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zM2 13a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm12 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z" />
                                    </svg>
                                </button>
                                <button class="btn nav-link dropdown-item py-1 text-center"
                                        role="menuitem"
                                        type="button"
                                        (click)="enableLocationTracking()"
                                        alt="Eigenen Standort anzeigen"
                                        title="Eigenen Standort anzeigen"
                                        i18n-alt
                                        i18n-title>
                                    <svg width="20px"
                                         height="20px"
                                         viewBox="0 0 16 16"
                                         class="bi bi-geo-fill"
                                         fill="currentColor"
                                         xmlns="http://www.w3.org/2000/svg"
                                         focusable="false"
                                         aria-hidden="true">
                                        <path fill-rule="evenodd"
                                              d="M4 4a4 4 0 1 1 4.5 3.969V13.5a.5.5 0 0 1-1 0V7.97A4 4 0 0 1 4 3.999zm2.493 8.574a.5.5 0 0 1-.411.575c-.712.118-1.28.295-1.655.493a1.319 1.319 0 0 0-.37.265.301.301 0 0 0-.057.09V14l.002.008a.147.147 0 0 0 .016.033.617.617 0 0 0 .145.15c.165.13.435.27.813.395.751.25 1.82.414 3.024.414s2.273-.163 3.024-.414c.378-.126.648-.265.813-.395a.619.619 0 0 0 .146-.15.148.148 0 0 0 .015-.033L12 14v-.004a.301.301 0 0 0-.057-.09 1.318 1.318 0 0 0-.37-.264c-.376-.198-.943-.375-1.655-.493a.5.5 0 1 1 .164-.986c.77.127 1.452.328 1.957.594C12.5 13 13 13.4 13 14c0 .426-.26.752-.544.977-.29.228-.68.413-1.116.558-.878.293-2.059.465-3.34.465-1.281 0-2.462-.172-3.34-.465-.436-.145-.826-.33-1.116-.558C3.26 14.752 3 14.426 3 14c0-.599.5-1 .961-1.243.505-.266 1.187-.467 1.957-.594a.5.5 0 0 1 .575.411z" />
                                    </svg>
                                </button>
                                <button type="button"
                                        role="menuitem"
                                        class="btn nav-link dropdown-item py-1 text-center"
                                        [ngClass]="{'active': threeDActive}"
                                        (click)="toggle3dView()"
                                        alt="3D aktivieren/deaktivieren"
                                        title="3D aktivieren/deaktivieren"
                                        i18n-alt
                                        i18n-title>
                                    <svg width="20px"
                                         height="20px"
                                         viewBox="0 0 16 16"
                                         class="bi bi-building"
                                         fill="currentColor"
                                         xmlns="http://www.w3.org/2000/svg"
                                         focusable="false"
                                         aria-hidden="true">
                                        <path fill-rule="evenodd"
                                              d="M14.763.075A.5.5 0 0 1 15 .5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V14h-1v1.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V10a.5.5 0 0 1 .342-.474L6 7.64V4.5a.5.5 0 0 1 .276-.447l8-4a.5.5 0 0 1 .487.022zM6 8.694L1 10.36V15h5V8.694zM7 15h2v-1.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5V15h2V1.309l-7 3.5V15z" />
                                        <path
                                              d="M2 11h1v1H2v-1zm2 0h1v1H4v-1zm-2 2h1v1H2v-1zm2 0h1v1H4v-1zm4-4h1v1H8V9zm2 0h1v1h-1V9zm-2 2h1v1H8v-1zm2 0h1v1h-1v-1zm2-2h1v1h-1V9zm0 2h1v1h-1v-1zM8 7h1v1H8V7zm2 0h1v1h-1V7zm2 0h1v1h-1V7zM8 5h1v1H8V5zm2 0h1v1h-1V5zm2 0h1v1h-1V5zm0-2h1v1h-1V3z" />
                                    </svg>
                                </button>
                                <button *ngIf="marker.getLngLat() && marker.getLngLat().lat != 0"
                                        type="button"
                                        role="menuitem"
                                        class="btn nav-link dropdown-item py-1 text-center"
                                        alt="Markierung fokussieren"
                                        title="Markierung fokussieren"
                                        (click)="flyTo(marker.getLngLat().lat, marker.getLngLat().lng, $event.type)"
                                        i18n-alt
                                        i18n-title>
                                    <svg xmlns="http://www.w3.org/2000/svg"
                                         width="20px"
                                         height="20px"
                                         fill="currentColor"
                                         class="bi bi-zoom-in"
                                         viewBox="0 0 16 16"
                                         focusable="false"
                                         aria-hidden="true">
                                        <path fill-rule="evenodd"
                                              d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z" />
                                        <path
                                              d="M10.344 11.742c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1 6.538 6.538 0 0 1-1.398 1.4z" />
                                        <path fill-rule="evenodd"
                                              d="M6.5 3a.5.5 0 0 1 .5.5V6h2.5a.5.5 0 0 1 0 1H7v2.5a.5.5 0 0 1-1 0V7H3.5a.5.5 0 0 1 0-1H6V3.5a.5.5 0 0 1 .5-.5z" />
                                    </svg>
                                </button>
                                <button class="btn nav-link dropdown-item py-1 text-center"
                                        type="button"
                                        role="menuitem"
                                        (click)="resetMap()"
                                        alt="Karte zurücksetzen"
                                        title="Karte zurücksetzen"
                                        aria-label="Karte und Adresseingabe zurücksetzen"
                                        i18n-alt
                                        i18n-title>
                                    <svg width="20px"
                                         height="20px"
                                         viewBox="0 0 16 16"
                                         class="bi bi-globe"
                                         fill="currentColor"
                                         xmlns="http://www.w3.org/2000/svg"
                                         focusable="false"
                                         aria-hidden="true">
                                        <path fill-rule="evenodd"
                                              d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm7.5-6.923c-.67.204-1.335.82-1.887 1.855A7.97 7.97 0 0 0 5.145 4H7.5V1.077zM4.09 4H2.255a7.025 7.025 0 0 1 3.072-2.472 6.7 6.7 0 0 0-.597.933c-.247.464-.462.98-.64 1.539zm-.582 3.5h-2.49c.062-.89.291-1.733.656-2.5H3.82a13.652 13.652 0 0 0-.312 2.5zM4.847 5H7.5v2.5H4.51A12.5 12.5 0 0 1 4.846 5zM8.5 5v2.5h2.99a12.495 12.495 0 0 0-.337-2.5H8.5zM4.51 8.5H7.5V11H4.847a12.5 12.5 0 0 1-.338-2.5zm3.99 0V11h2.653c.187-.765.306-1.608.338-2.5H8.5zM5.145 12H7.5v2.923c-.67-.204-1.335-.82-1.887-1.855A7.97 7.97 0 0 1 5.145 12zm.182 2.472a6.696 6.696 0 0 1-.597-.933A9.268 9.268 0 0 1 4.09 12H2.255a7.024 7.024 0 0 0 3.072 2.472zM3.82 11H1.674a6.958 6.958 0 0 1-.656-2.5h2.49c.03.877.138 1.718.312 2.5zm6.853 3.472A7.024 7.024 0 0 0 13.745 12H11.91a9.27 9.27 0 0 1-.64 1.539 6.688 6.688 0 0 1-.597.933zM8.5 12h2.355a7.967 7.967 0 0 1-.468 1.068c-.552 1.035-1.218 1.65-1.887 1.855V12zm3.68-1h2.146c.365-.767.594-1.61.656-2.5h-2.49a13.65 13.65 0 0 1-.312 2.5zm2.802-3.5h-2.49A13.65 13.65 0 0 0 12.18 5h2.146c.365.767.594 1.61.656 2.5zM11.27 2.461c.247.464.462.98.64 1.539h1.835a7.024 7.024 0 0 0-3.072-2.472c.218.284.418.598.597.933zM10.855 4H8.5V1.077c.67.204 1.335.82 1.887 1.855.173.324.33.682.468 1.068z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
        </div>
    </div>

    <power-geosearch [class.d-none]="!searchActive"
                     [class]="isCollapsed ? 'd-lg-none' : 'd-xxl-none'"
                     [adresse]="adresse"
                     (selectResult)="onSearchSelect($event)"></power-geosearch>

    <div [class.d-none]="!filterActive"
         [class]="isCollapsed ? 'd-lg-none' : 'd-xxl-none'">
        <div class="btn-group d-flex w-100">
            <div class="btn-group"
                 role="group"
                 style="flex: 1;"
                 dropdown>
                <button id="button-stichtage-2"
                        dropdownToggle
                        type="button"
                        class="btn btn-block dropdown-toggle"
                        aria-controls="dropdown-stichtage-2"
                        aria-haspopup="true">
                    {{stichtag | date}} <span class="caret"
                          aria-hidden="true"></span>
                </button>
                <div id="dropdown-stichtage-2"
                     *dropdownMenu
                     class="dropdown-menu"
                     role="menu"
                     aria-labelledby="button-stichtage-2">
                    <button type="button"
                            role="menuitem"
                            class="dropdown-item"
                            *ngFor="let stag of bodenrichtwertService.STICHTAGE"
                            (click)="onStichtagChange(stag)">
                        {{stag | date}}
                    </button>
                </div>
            </div>

            <div class="btn-group"
                 role="group"
                 style="flex: 1;"
                 dropdown>
                <button id="button-teilmarkt-2"
                        dropdownToggle
                        type="button"
                        class="btn btn-block dropdown-toggle"
                        aria-controls="dropdown-teilmarkt-2"
                        aria-haspopup="true">
                    {{teilmarkt.viewValue}} <span class="caret"
                          aria-hidden="true"></span>
                </button>
                <div id="dropdown-teilmarkt-2"
                     *dropdownMenu
                     class="dropdown-menu dropdown-menu-right"
                     role="menu"
                     aria-labelledby="button-teilmarkt-2">
                    <button type="button"
                            role="menuitem"
                            class="dropdown-item"
                            *ngFor="let tm of bodenrichtwertService.TEILMAERKTE"
                            (click)="onTeilmarktChange(tm)">
                        <svg width="0.75em"
                             height="0.75em"
                             viewBox="0 0 16 16"
                             class="bi bi-circle-fill"
                             [attr.fill]="tm.color"
                             xmlns="http://www.w3.org/2000/svg"
                             focusable="false"
                             aria-hidden="true">
                            <circle cx="8"
                                    cy="8"
                                    r="8" />
                        </svg>
                        {{tm.viewValue}}
                    </button>
                </div>
            </div>
        </div>
    </div>

    <mgl-map (click)="onMapClickEvent($event)"
             (mouseUp)="onDragEnd()"
             (touchEnd)="onDragEnd()"
             (moveEnd)="onMoveEnd()"
             (resize)="onMoveEnd()"
             (load)="loadMap($event)"
             [bounds]="bounds"
             [maxZoom]="20"
             [minZoom]="5"
             [style]="MAP_STYLE_URL"
             [trackResize]="true"
             id="map">

        <mgl-geojson-source id="ndsgeojson"
                            [data]="baseUrl+'/assets/boden/niedersachsen.geojson'"></mgl-geojson-source>
        <mgl-geojson-source id="baulandSource"
                            [data]="baulandData">
        </mgl-geojson-source>

        <mgl-geojson-source id="landwirtschaftSource"
                            [data]="landwirtschaftData">
        </mgl-geojson-source>

        <mgl-layer id="nds"
                   type="line"
                   [source]="'ndsgeojson'"
                   [paint]="{
                        'line-color': '#c4153a',
                        'line-width': {
                            'stops': [[8,1],[10,1],[18,1]]
                        },
                        'line-opacity': {
                            'stops':[[8,1],[10,1],[12,0]]
                        }
                    }">
        </mgl-layer>

        <!-- Niedersachsen -->
        <mgl-layer id="flurstuecke"
                   type="line"
                   [source]="ndsFstSource"
                   [minzoom]="15"
                   [sourceLayer]="'ax_flurstueck_nds'"
                   [paint]="{
                        'line-color': '#96999e',
                        'line-width': {
                            'stops': [[15,0],[16,1],[18,2]]
                        },
                        'line-opacity': {
                            'stops' : [[15,0.5]]
                        }
                    }">
        </mgl-layer>

        <mgl-layer id="bauland"
                   type="line"
                   [source]="ndsSource"
                   [minzoom]="11"
                   [sourceLayer]="'br_brzone_flat_with_display'"
                   [paint]="{
                        'line-color': teilmarkt.color,
                        'line-width': {
                            'stops': [[11,0],[13,1],[18,2]]
                        },
                        'line-opacity': {
                            'stops' : [[11,0],[13,1]]
                        }
                    }"
                   [layout]="teilmarkt.value.includes('B') ? {visibility: 'visible'} : {visibility: 'none'}"
                   [filter]="['all',['in', 'entw', 'B', 'SF', 'R', 'E'],['==', 'stag', stichtag]]">
        </mgl-layer>

        <mgl-layer id="sanierungsgebiet"
                   type="line"
                   [source]="ndsSource"
                   [minzoom]="11"
                   [sourceLayer]="'br_brzone_flat_with_display'"
                   [paint]="{
                        'line-color': '#0080FF',
                        'line-dasharray': [7,5],
                        'line-width': {
                            'stops': [[11,0],[13,2],[18,4]]
                            },
                            'line-opacity': {
                                'stops' : [[11,0],[13,.6]]
                            }
                    }"
                   [layout]="teilmarkt.value.includes('B') ? {visibility: 'visible'} : {visibility: 'none'}"
                   [filter]="['all',['in', 'verg', 'San', 'SoSt', 'Entw', 'StUb'],['==', 'stag', stichtag]]">
        </mgl-layer>

        <mgl-layer id="landwirtschaft"
                   type="line"
                   [source]="ndsSource"
                   [sourceLayer]="'br_brzone_flat_with_display'"
                   [minzoom]="10"
                   [paint]="{
                        'line-color': teilmarkt.color,
                        'line-width': {
                            'stops': [[8,0],[10,1],[11,2]]
                        },
                        'line-opacity': {
                            'stops' : [[8,0],[10,1]]
                        }
                    }"
                   [layout]="teilmarkt.value.includes('LF') ? {visibility: 'visible'} : {visibility: 'none'}"
                   [filter]="['all',['==', 'entw', 'LF'], ['==','stag',stichtag]]">
        </mgl-layer>

        <!-- Bremen -->
        <mgl-layer id="bauland_bremen"
                   type="line"
                   [source]="bremenSource"
                   [minzoom]="11"
                   [sourceLayer]="'br_brzone_flat_bremen_with_display'"
                   [paint]="{
                        'line-color': teilmarkt.color,
                        'line-width': {
                            'stops': [[11,0],[13,1],[18,2]]
                        },
                        'line-opacity': {
                            'stops' : [[11,0],[13,1]]
                        }
                    }"
                   [layout]="teilmarkt.value.includes('B') ? {visibility: 'visible'} : {visibility: 'none'}"
                   [filter]="['all',['in', 'entw', 'B', 'SF', 'R', 'E'],['==', 'stag', stichtag]]">
        </mgl-layer>

        <mgl-layer id="sanierungsgebiet_bremen"
                   type="line"
                   [source]="bremenSource"
                   [minzoom]="11"
                   [sourceLayer]="'br_brzone_flat_bremen_with_display'"
                   [paint]="{
                        'line-color': '#0080FF',
                        'line-dasharray': [7,5],
                        'line-width': {
                            'stops': [[11,0],[13,2],[18,4]]
                            },
                            'line-opacity': {
                                'stops' : [[11,0],[13,.6]]
                            }
                    }"
                   [layout]="teilmarkt.value.includes('B') ? {visibility: 'visible'} : {visibility: 'none'}"
                   [filter]="['all',['in', 'verg', 'San', 'SoSt', 'Entw', 'StUb'],['==', 'stag', stichtag]]">
        </mgl-layer>

        <mgl-layer id="landwirtschaft_bremen"
                   type="line"
                   [source]="bremenSource"
                   [sourceLayer]="'br_brzone_flat_bremen_with_display'"
                   [minzoom]="10"
                   [paint]="{
                        'line-color': teilmarkt.color,
                        'line-width': {
                            'stops': [[8,0],[10,1],[11,2]]
                        },
                        'line-opacity': {
                            'stops' : [[8,0],[10,1]]
                        }
                    }"
                   [layout]="teilmarkt.value.includes('LF') ? {visibility: 'visible'} : {visibility: 'none'}"
                   [filter]="['all',['==', 'entw', 'LF'], ['==','stag',stichtag]]">
        </mgl-layer>

        <!-- Labels -->

        <mgl-layer id="bauland_labels"
                   type="symbol"
                   source="baulandSource"
                   [paint]="{
                        'text-halo-color': '#fff',
                        'text-halo-width': 2,
                        'text-halo-blur': 2,
                        'text-color': teilmarkt.color
                    }"
                   [layout]="{
                        'visibility': 'visible',
                        'text-field': ['get', 'display'],
                        'text-max-width': 0,
                        'text-size': {
                            'stops': [[12, 10], [15, 16]]
                        },
                        'text-font': ['Klokantech Noto Sans Regular']
                   }">
        </mgl-layer>

        <mgl-layer id="landwirtschaft_labels"
                   type="symbol"
                   source="landwirtschaftSource"
                   [paint]="{
                        'text-halo-color': '#fff',
                        'text-halo-width': 2,
                        'text-halo-blur': 2,
                        'text-color': teilmarkt.color
                    }"
                   [layout]="{
                        'visibility': 'visible',
                        'text-field': ['get', 'display'],
                        'text-max-width': 0,
                        'text-size': {
                            'stops': [[10, 20], [15, 24]]
                        },
                        'text-font': ['Klokantech Noto Sans Regular']
                    }">
        </mgl-layer>

        <mgl-control [position]="'bottom-left'"
                     mglScale
                     unit="metric"></mgl-control>
    </mgl-map>
</div>

<power-flurstueck-search #flurstueckssearch
                         (fskChange)="onFlurstueckChange()"></power-flurstueck-search>
