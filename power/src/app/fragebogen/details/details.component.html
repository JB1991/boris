<!-- details page -->
<main class="mainpage p-1 p-lg-3" id="content" tabindex="-1" *ngIf="form">
    <!-- title -->
    <div class="h4">
        <svg width="1em"
             height="1em"
             viewBox="0 0 16 16"
             class="bi bi-file-earmark-medical"
             fill="currentColor"
             xmlns="http://www.w3.org/2000/svg"
             focusable="false"
             aria-hidden="true">
            <path
                d="M4 1h5v1H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V6h1v7a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2z" />
            <path d="M9 4.5V1l5 5h-3.5A1.5 1.5 0 0 1 9 4.5z" />
            <path fill-rule="evenodd"
                d="M7 4a.5.5 0 0 1 .5.5v.634l.549-.317a.5.5 0 1 1 .5.866L8 6l.549.317a.5.5 0 1 1-.5.866L7.5 6.866V7.5a.5.5 0 0 1-1 0v-.634l-.549.317a.5.5 0 1 1-.5-.866L6 6l-.549-.317a.5.5 0 0 1 .5-.866l.549.317V4.5A.5.5 0 0 1 7 4zM5 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z" />
        </svg> {{ form.extract }}

        <button type="button"
                class="btn btn-secondary btn-sm float-right d-none d-md-inline"
                i18n-title
                title="Zurück zum Dashboard"
                [routerLink]="['/forms/dashboard']">
            <svg width="1em"
                 height="1em"
                 viewBox="0 0 16 16"
                 class="bi bi-backspace"
                 fill="currentColor"
                 xmlns="http://www.w3.org/2000/svg"
                 focusable="false"
                 aria-hidden="true">
                <path fill-rule="evenodd"
                    d="M6.603 2h7.08a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1h-7.08a1 1 0 0 1-.76-.35L1 8l4.844-5.65A1 1 0 0 1 6.603 2zm7.08-1a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-7.08a2 2 0 0 1-1.519-.698L.241 8.65a1 1 0 0 1 0-1.302L5.084 1.7A2 2 0 0 1 6.603 1h7.08z" />
                <path fill-rule="evenodd"
                    d="M5.83 5.146a.5.5 0 0 0 0 .708l5 5a.5.5 0 0 0 .707-.708l-5-5a.5.5 0 0 0-.708 0z" />
                <path fill-rule="evenodd"
                    d="M11.537 5.146a.5.5 0 0 1 0 .708l-5 5a.5.5 0 0 1-.708-.708l5-5a.5.5 0 0 1 .707 0z" />
            </svg>
            <span class="ml-1" i18n>Zurück</span>
        </button>
    </div>

    <!-- form details -->
    <div class="row m-0 mb-3">
        <div class="col-12 col-md-6 pl-0">
            <p class="font-weight-light mb-1">
                <span i18n>ID</span>: {{ form.id }}
            </p>
            <p class="font-weight-light mb-1">
                <span i18n>Besitzer</span>: {{ form.owner.name }}
            </p>
            <p class="font-weight-light mb-1">
                <span i18n>Erstellt</span>: {{ form.created | date:'short' }}
            </p>
            <p class="font-weight-light mb-1">
                <span i18n>Verändert</span>: {{ form.updated | date:'short' }}
            </p>
        </div>
        <div class="col-12 col-md-6 pl-0">
            <p class="font-weight-light mb-1" *ngIf="form.status === 'published'">
                <span i18n>Zugriff</span>: {form.access, select, public {Öffentlich} pin6 {6-stellige PIN} pin8 {8-stellige PIN}}
            </p>
            <p class="font-weight-light mb-1">
                <span i18n>Status</span>: {form.status, select, created {Erstellt} published {Veröffentlicht} cancelled {Geschlossen}}
            </p>
            <p *ngIf="form.tags && form.tags.length > 0" class="font-weight-light mb-1">
                <span i18n>Tags</span>: {{ form.tags.join(', ') }}
            </p>
            <p *ngIf="form.groups && form.groups.length > 0" class="font-weight-light mb-1">
                <span i18n>Gruppen</span>: {{ form.groups.join(', ') }}
            </p>
        </div>
        <div class="col-12 pl-0 pt-2">
            <button type="button"
                    class="btn btn-primary btn-sm mr-2"
                    i18n-title
                    title="Formular bearbeiten"
                    [routerLink]="['/forms/editor', form.id]"
                    *ngIf="form.status === 'created' && auth.IsAuthorized(['admin', 'manager'], form.owner.id, form.groups)">
                <svg width="1em"
                     height="1em"
                     viewBox="0 0 16 16"
                     class="bi bi-pencil-square"
                     fill="currentColor"
                     xmlns="http://www.w3.org/2000/svg"
                     focusable="false"
                     aria-hidden="true">
                    <path
                        d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456l-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z" />
                    <path fill-rule="evenodd"
                        d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z" />
                </svg>
                <span class="d-none d-sm-inline ml-1" i18n>Bearbeiten</span>
            </button>
            <button type="button"
                    class="btn btn-primary btn-sm mr-2"
                    i18n-title
                    title="Formular Vorschau"
                    (click)="preview.open()">
                <svg width="1em"
                     height="1em"
                     viewBox="0 0 16 16"
                     class="bi bi-arrows-fullscreen"
                     fill="currentColor"
                     xmlns="http://www.w3.org/2000/svg"
                     focusable="false"
                     aria-hidden="true">
                    <path fill-rule="evenodd"
                        d="M1.464 10.536a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3.5a.5.5 0 0 1-.5-.5v-3.5a.5.5 0 0 1 .5-.5z" />
                    <path fill-rule="evenodd"
                        d="M5.964 10a.5.5 0 0 1 0 .707l-4.146 4.147a.5.5 0 0 1-.707-.708L5.257 10a.5.5 0 0 1 .707 0zm8.854-8.854a.5.5 0 0 1 0 .708L10.672 6a.5.5 0 0 1-.708-.707l4.147-4.147a.5.5 0 0 1 .707 0z" />
                    <path fill-rule="evenodd"
                        d="M10.5 1.5A.5.5 0 0 1 11 1h3.5a.5.5 0 0 1 .5.5V5a.5.5 0 0 1-1 0V2h-3a.5.5 0 0 1-.5-.5zm4 9a.5.5 0 0 0-.5.5v3h-3a.5.5 0 0 0 0 1h3.5a.5.5 0 0 0 .5-.5V11a.5.5 0 0 0-.5-.5z" />
                    <path fill-rule="evenodd"
                        d="M10 9.964a.5.5 0 0 0 0 .708l4.146 4.146a.5.5 0 0 0 .708-.707l-4.147-4.147a.5.5 0 0 0-.707 0zM1.182 1.146a.5.5 0 0 0 0 .708L5.328 6a.5.5 0 0 0 .708-.707L1.889 1.146a.5.5 0 0 0-.707 0z" />
                    <path fill-rule="evenodd"
                        d="M5.5 1.5A.5.5 0 0 0 5 1H1.5a.5.5 0 0 0-.5.5V5a.5.5 0 0 0 1 0V2h3a.5.5 0 0 0 .5-.5z" />
                </svg>
                <span class="d-none d-sm-inline ml-1" i18n>Vorschau</span>
            </button>
            <button type="button"
                    class="btn btn-primary btn-sm mr-2"
                    i18n-title
                    title="Formular exportieren"
                    (click)="exportForm()">
                <svg width="1em"
                     height="1em"
                     viewBox="0 0 16 16"
                     class="bi bi-cloud-arrow-down"
                     fill="currentColor"
                     xmlns="http://www.w3.org/2000/svg"
                     focusable="false"
                     aria-hidden="true">
                    <path fill-rule="evenodd"
                        d="M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z" />
                    <path fill-rule="evenodd"
                        d="M7.646 10.854a.5.5 0 0 0 .708 0l2-2a.5.5 0 0 0-.708-.708L8.5 9.293V5.5a.5.5 0 0 0-1 0v3.793L6.354 8.146a.5.5 0 1 0-.708.708l2 2z" />
                </svg>
                <span class="d-none d-sm-inline ml-1" i18n>Formular exportieren</span>
            </button>
            <button type="button" class="btn btn-primary btn-sm mr-2" i18n-title title="Formular Einstellungen" (click)="settings.open(form)" *ngIf="auth.IsAuthorized(['admin', 'manager', 'editor'], form.owner.id, form.groups)">
                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-gear" fill="currentColor"
                    xmlns="http://www.w3.org/2000/svg" focusable="false" aria-hidden="true">
                    <path fill-rule="evenodd"
                        d="M8.837 1.626c-.246-.835-1.428-.835-1.674 0l-.094.319A1.873 1.873 0 0 1 4.377 3.06l-.292-.16c-.764-.415-1.6.42-1.184 1.185l.159.292a1.873 1.873 0 0 1-1.115 2.692l-.319.094c-.835.246-.835 1.428 0 1.674l.319.094a1.873 1.873 0 0 1 1.115 2.693l-.16.291c-.415.764.42 1.6 1.185 1.184l.292-.159a1.873 1.873 0 0 1 2.692 1.116l.094.318c.246.835 1.428.835 1.674 0l.094-.319a1.873 1.873 0 0 1 2.693-1.115l.291.16c.764.415 1.6-.42 1.184-1.185l-.159-.291a1.873 1.873 0 0 1 1.116-2.693l.318-.094c.835-.246.835-1.428 0-1.674l-.319-.094a1.873 1.873 0 0 1-1.115-2.692l.16-.292c.415-.764-.42-1.6-1.185-1.184l-.291.159A1.873 1.873 0 0 1 8.93 1.945l-.094-.319zm-2.633-.283c.527-1.79 3.065-1.79 3.592 0l.094.319a.873.873 0 0 0 1.255.52l.292-.16c1.64-.892 3.434.901 2.54 2.541l-.159.292a.873.873 0 0 0 .52 1.255l.319.094c1.79.527 1.79 3.065 0 3.592l-.319.094a.873.873 0 0 0-.52 1.255l.16.292c.893 1.64-.902 3.434-2.541 2.54l-.292-.159a.873.873 0 0 0-1.255.52l-.094.319c-.527 1.79-3.065 1.79-3.592 0l-.094-.319a.873.873 0 0 0-1.255-.52l-.292.16c-1.64.893-3.433-.902-2.54-2.541l.159-.292a.873.873 0 0 0-.52-1.255l-.319-.094c-1.79-.527-1.79-3.065 0-3.592l.319-.094a.873.873 0 0 0 .52-1.255l-.16-.292c-.892-1.64.902-3.433 2.541-2.54l.292.159a.873.873 0 0 0 1.255-.52l.094-.319z" />
                    <path fill-rule="evenodd"
                        d="M8 5.754a2.246 2.246 0 1 0 0 4.492 2.246 2.246 0 0 0 0-4.492zM4.754 8a3.246 3.246 0 1 1 6.492 0 3.246 3.246 0 0 1-6.492 0z" />
                </svg>
                <span class="d-none d-sm-inline ml-1" i18n>Einstellungen</span>
            </button>
            <button type="button"
                    class="btn btn-success btn-sm mr-2"
                    i18n-title
                    title="Formular veröffentlichen"
                    (click)="publish.open(form.id)"
                    *ngIf="form.status === 'created' && auth.IsAuthorized(['admin', 'manager'], form.owner.id, form.groups)">
                <svg width="1em"
                     height="1em"
                     viewBox="0 0 16 16"
                     class="bi bi-globe2"
                     fill="currentColor"
                     xmlns="http://www.w3.org/2000/svg"
                     focusable="false"
                     aria-hidden="true">
                    <path fill-rule="evenodd"
                        d="M1.018 7.5h2.49c.037-1.07.189-2.087.437-3.008a9.124 9.124 0 0 1-1.565-.667A6.964 6.964 0 0 0 1.018 7.5zM3.05 3.049c.362.184.763.349 1.198.49.142-.384.304-.744.481-1.078a6.7 6.7 0 0 1 .597-.933A7.01 7.01 0 0 0 3.051 3.05zM8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm-.5 1.077c-.67.204-1.335.82-1.887 1.855-.143.268-.276.56-.395.872.705.157 1.473.257 2.282.287V1.077zm0 4.014c-.91-.03-1.783-.145-2.591-.332a12.344 12.344 0 0 0-.4 2.741H7.5V5.091zm1 2.409V5.091c.91-.03 1.783-.145 2.591-.332.223.827.364 1.754.4 2.741H8.5zm-1 1H4.51c.035.987.176 1.914.399 2.741A13.596 13.596 0 0 1 7.5 10.91V8.5zm1 2.409V8.5h2.99a12.343 12.343 0 0 1-.399 2.741A13.596 13.596 0 0 0 8.5 10.91zm-1 1c-.81.03-1.577.13-2.282.287.12.312.252.604.395.872.552 1.035 1.218 1.65 1.887 1.855V11.91zm-2.173 2.563a6.695 6.695 0 0 1-.597-.933 8.857 8.857 0 0 1-.481-1.078 8.356 8.356 0 0 0-1.198.49 7.01 7.01 0 0 0 2.276 1.52zM2.38 12.175c.47-.258.995-.482 1.565-.667A13.36 13.36 0 0 1 3.508 8.5h-2.49a6.964 6.964 0 0 0 1.362 3.675zm8.293 2.297a7.01 7.01 0 0 0 2.275-1.521 8.353 8.353 0 0 0-1.197-.49 8.859 8.859 0 0 1-.481 1.078 6.688 6.688 0 0 1-.597.933zm.11-2.276A12.63 12.63 0 0 0 8.5 11.91v3.014c.67-.204 1.335-.82 1.887-1.855.143-.268.276-.56.395-.872zm1.272-.688c.57.185 1.095.409 1.565.667A6.964 6.964 0 0 0 14.982 8.5h-2.49a13.355 13.355 0 0 1-.437 3.008zm.437-4.008h2.49a6.963 6.963 0 0 0-1.362-3.675c-.47.258-.995.482-1.565.667.248.92.4 1.938.437 3.008zm-.74-3.96a8.854 8.854 0 0 0-.482-1.079 6.692 6.692 0 0 0-.597-.933c.857.355 1.63.875 2.275 1.521a8.368 8.368 0 0 1-1.197.49zm-.97.264c-.705.157-1.473.257-2.282.287V1.077c.67.204 1.335.82 1.887 1.855.143.268.276.56.395.872z" />
                </svg>
                <span class="d-none d-sm-inline ml-1" i18n>Veröffentlichen</span>
            </button>
            <button type="button"
                    class="btn btn-secondary btn-sm mr-2"
                    i18n-title
                    title="Formular archivieren"
                    (click)="archiveForm()"
                    *ngIf="form.status !== 'cancelled' && auth.IsAuthorized(['admin', 'manager'], form.owner.id, form.groups)">
                <svg width="1em"
                     height="1em"
                     viewBox="0 0 16 16"
                     class="bi bi-archive-fill"
                     fill="currentColor"
                     xmlns="http://www.w3.org/2000/svg"
                     focusable="false"
                     aria-hidden="true">
                    <path fill-rule="evenodd"
                        d="M12.643 15C13.979 15 15 13.845 15 12.5V5H1v7.5C1 13.845 2.021 15 3.357 15h9.286zM6 7a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1H6zM.8 1a.8.8 0 0 0-.8.8V3a.8.8 0 0 0 .8.8h14.4A.8.8 0 0 0 16 3V1.8a.8.8 0 0 0-.8-.8H.8z" />
                </svg>
                <span class="d-none d-sm-inline ml-1" i18n>Archivieren</span>
            </button>
            <button type="button"
                    class="btn btn-danger btn-sm"
                    i18n-title
                    title="Formular löschen"
                    (click)="deleteForm()"
                    *ngIf="form.status === 'cancelled' && auth.IsAuthorized(['admin', 'manager'], form.owner.id, form.groups)">
                <svg width="1em"
                     height="1em"
                     viewBox="0 0 16 16"
                     class="bi bi-trash-fill"
                     fill="currentColor"
                     xmlns="http://www.w3.org/2000/svg"
                     focusable="false"
                     aria-hidden="true">
                    <path fill-rule="evenodd"
                        d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5a.5.5 0 0 0-1 0v7a.5.5 0 0 0 1 0v-7z" />
                </svg>
                <span class="d-none d-sm-inline ml-1" i18n>Löschen</span>
            </button>
        </div>
    </div>

    <!-- tasks list -->
    <div class="card bg-light" *ngIf="tasks && form.status !== 'created'">
        <div class="card-header h5">
            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-list-ul" fill="currentColor" xmlns="http://www.w3.org/2000/svg" focusable="false" aria-hidden="true">
                <path fill-rule="evenodd"
                    d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2z" />
            </svg>
            <span class="ml-1" i18n>Antworten</span>
            <div class="float-md-right row">
                <div class="col-sm">
                    <select class="browser-default custom-select" (change)="taskStatus = $event.target.value; this.updateTasks()" aria-roledescription="Antworten filtern nach Status.">
                        <option value="all" selected i18n>Status: Alle</option>
                        <option value="created" i18n>Status: Erstellt</option>
                        <option value="accessed" i18n>Status: Bearbeitet</option>
                        <option value="submitted" i18n>Status: Ausgeführt</option>
                        <option value="completed" i18n>Status: Abgeschlossen</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="card-body table-responsive p-0">
            <table class="table table-hover m-0">
                <thead>
                    <tr>
                        <th scope="col" (click)="changeTaskSort('pin')" class="border-top-0">
                            <span role="button" (keyup.enter)="changeTaskSort('pin')" aria-roledescription="Aufsteigend oder Absteigend sortieren." aria-describedby="ascPin descPin" i18n-aria-roledescription tabindex="0" i18n>Pin</span>
                                <span *ngIf="taskSort && taskSort === 'pin'">
                                    <span *ngIf="!taskSortDesc" id="ascPin" aria-label="Aufsteigend sortiert"
                                        i18n-aria-label>
                                        <svg width="1em" height="0.8em" viewBox="0 1.2 16 16" class="bi bi-arrow-up"
                                            fill="currentColor" xmlns="http://www.w3.org/2000/svg" focusable="false"
                                            aria-hidden="true">
                                            <path
                                                d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z" />
                                        </svg>
                                        <span class="sr-only" i18n>Aufsteigend sortiert</span>
                                </span>
                                <span *ngIf="taskSortDesc" id="descPin" aria-label="Absteigend sortiert" i18n-aria-label>
                                        <svg width="1em" height="0.8em" viewBox="0 1.2 16 16" class="bi bi-arrow-down"
                                            fill="currentColor" xmlns="http://www.w3.org/2000/svg" focusable="false"
                                            aria-hidden="true">
                                            <path
                                                d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z" />
                                        </svg>
                                        <span class="sr-only" i18n>Absteigend sortiert</span>
                                </span>
                            </span>
                        </th>
                        <th scope="col" (click)="changeTaskSort('pin')" class="border-top-0">
                            <span role="button" (keyup.enter)="changeTaskSort('pin')" aria-roledescription="Aufsteigend oder Absteigend sortieren." aria-describedby="ascDescription descDescription" i18n-aria-roledescription tabindex="0" i18n>Kommentar</span>
                                <span *ngIf="taskSort && taskSort === 'description'">
                                    <span *ngIf="!taskSortDesc" id="ascDescription" aria-label="Aufsteigend sortiert"
                                        i18n-aria-label>
                                        <svg width="1em" height="0.8em" viewBox="0 1.2 16 16" class="bi bi-arrow-up"
                                            fill="currentColor" xmlns="http://www.w3.org/2000/svg" focusable="false"
                                            aria-hidden="true">
                                            <path
                                                d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z" />
                                        </svg>
                                        <span class="sr-only" i18n>Aufsteigend sortiert</span>
                                </span>
                                <span *ngIf="taskSortDesc" id="descDescription" aria-label="Absteigend sortiert" i18n-aria-label>
                                        <svg width="1em" height="0.8em" viewBox="0 1.2 16 16" class="bi bi-arrow-down"
                                            fill="currentColor" xmlns="http://www.w3.org/2000/svg" focusable="false"
                                            aria-hidden="true">
                                            <path
                                                d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z" />
                                        </svg>
                                        <span class="sr-only" i18n>Absteigend sortiert</span>
                                </span>
                            </span>
                        </th>
                        <th scope="col" (click)="changeTaskSort('pin')" class="border-top-0">
                            <span role="button" (keyup.enter)="changeTaskSort('pin')" aria-roledescription="Aufsteigend oder Absteigend sortieren." aria-describedby="ascStatus descStatus" i18n-aria-roledescription tabindex="0" i18n>Status</span>
                            <span *ngIf="taskSort && taskSort === 'status'">
                                <span *ngIf="!taskSortDesc" id="ascStatus" aria-label="Aufsteigend sortiert"
                                    i18n-aria-label>
                                    <svg width="1em" height="0.8em" viewBox="0 1.2 16 16" class="bi bi-arrow-up"
                                        fill="currentColor" xmlns="http://www.w3.org/2000/svg" focusable="false"
                                        aria-hidden="true">
                                        <path
                                            d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z" />
                                    </svg>
                                    <span class="sr-only" i18n>Aufsteigend sortiert</span>
                            </span>
                            <span *ngIf="taskSortDesc" id="descStatus" aria-label="Absteigend sortiert" i18n-aria-label>
                                    <svg width="1em" height="0.8em" viewBox="0 1.2 16 16" class="bi bi-arrow-down"
                                        fill="currentColor" xmlns="http://www.w3.org/2000/svg" focusable="false"
                                        aria-hidden="true">
                                        <path
                                            d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z" />
                                    </svg>
                                    <span class="sr-only" i18n>Absteigend sortiert</span>
                            </span>
                            </span>
                        </th>
                        <th scope="col" (click)="changeTaskSort('pin')" class="border-top-0">
                            <span role="button" (keyup.enter)="changeTaskSort('pin')" i18n>Erstellt</span>
                            <span *ngIf="taskSort && taskSort === 'created'">
                                <span *ngIf="!taskSortDesc">
                                    <svg width="1em" height="0.8em" viewBox="0 1.2 16 16" class="bi bi-arrow-up"
                                        fill="currentColor" xmlns="http://www.w3.org/2000/svg" focusable="false"
                                        role="button" aria-hidden="true">
                                        <path
                                            d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z" />
                                    </svg>
                                    <span class="sr-only" i18n>Aufsteigend sortiert</span>
                            </span>
                            <span *ngIf="taskSortDesc">
                                    <svg width="1em" height="0.8em" viewBox="0 1.2 16 16" class="bi bi-arrow-down"
                                        fill="currentColor" xmlns="http://www.w3.org/2000/svg" focusable="false"
                                        role="button" aria-hidden="true">
                                        <path
                                            d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z" />
                                    </svg>
                                    <span class="sr-only" i18n>Absteigend sortiert</span>
                            </span>
                            </span>
                        </th>
                        <th scope="col" (click)="changeTaskSort('pin')" class="border-top-0">
                            <span role="button" (keyup.enter)="changeTaskSort('pin')" i18n>Verändert</span>
                            <span *ngIf="taskSort && taskSort === 'updated'">
                                <span *ngIf="!taskSortDesc">
                                    <svg width="1em" height="0.8em" viewBox="0 1.2 16 16" class="bi bi-arrow-up"
                                        fill="currentColor" xmlns="http://www.w3.org/2000/svg" focusable="false"
                                        role="button" aria-hidden="true">
                                        <path
                                            d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z" />
                                    </svg>
                                    <span class="sr-only" i18n>Aufsteigend sortiert</span>
                            </span>
                            <span *ngIf="taskSortDesc">
                                    <svg width="1em" height="0.8em" viewBox="0 1.2 16 16" class="bi bi-arrow-down"
                                        fill="currentColor" xmlns="http://www.w3.org/2000/svg" focusable="false"
                                        role="button" aria-hidden="true">
                                        <path
                                            d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z" />
                                    </svg>
                                    <span class="sr-only" i18n>Absteigend sortiert</span>
                            </span>
                            </span>
                        </th>
                        <th scope="col" class="border-top-0 w-75"></th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let task of tasks; index as i">
                        <td *ngIf="form.access !== 'public'">
                            <a [routerLink]="['/forms/fillout', task.pin]" *ngIf="task.status !== 'submitted' && task.pin !== undefined && task.pin !== ''">
                                {{ task.pin }}
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-link-45deg"
                                    fill="currentColor" xmlns="http://www.w3.org/2000/svg" focusable="false"
                                    aria-hidden="true">
                                    <path
                                        d="M4.715 6.542L3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.001 1.001 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z" />
                                    <path
                                        d="M5.712 6.96l.167-.167a1.99 1.99 0 0 1 .896-.518 1.99 1.99 0 0 1 .518-.896l.167-.167A3.004 3.004 0 0 0 6 5.499c-.22.46-.316.963-.288 1.46z" />
                                    <path
                                        d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 0 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 0 0-4.243-4.243L6.586 4.672z" />
                                    <path
                                        d="M10 9.5a2.99 2.99 0 0 0 .288-1.46l-.167.167a1.99 1.99 0 0 1-.896.518 1.99 1.99 0 0 1-.518.896l-.167.167A3.004 3.004 0 0 0 10 9.501z" />
                                </svg>
                            </a>
                        </td>
                        <td>
                            {{ task.description }}
                            <span *ngIf="auth.IsAuthorized(['admin', 'manager', 'editor'], form.owner.id, form.groups)"
                                class="ml-1 text-primary clickable"
                                i18n-title title="Bearbeiten"
                                role="button"
                                tabindex="0"
                                (click)="comment.open(task)"
                                (keyup.enter)="comment.open(task)">
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-pencil-square"
                                    fill="currentColor" xmlns="http://www.w3.org/2000/svg" focusable="false"
                                    aria-hidden="true">
                                    <path
                                        d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456l-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z" />
                                    <path fill-rule="evenodd"
                                        d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z" />
                                </svg>
                                <span class="sr-only" i18n>Bearbeiten</span>
                            </span>
                        </td>
                        <td>{task.status, select, created {Erstellt} accessed {Bearbeitet} submitted {Ausgeführt} completed {Abgeschlossen}}</td>
                        <td>{{ task.created | date:'short' }}</td>
                        <td>{{ task.updated | date:'short' }}</td>
                        <td>
                            <button type="button"
                                    class="btn btn-primary btn-sm mr-2"
                                    i18n-title
                                    title="Neue PIN generieren"
                                    (click)="newPin(i)"
                                    *ngIf="form.access !== 'public' && auth.IsAuthorized(['admin', 'manager', 'editor'], form.owner.id, form.groups)">
                                <svg width="1em"
                                     height="1em"
                                     viewBox="0 0 16 16"
                                     class="bi bi-arrow-clockwise"
                                     fill="currentColor"
                                     xmlns="http://www.w3.org/2000/svg"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
                                    <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
                                </svg>
                                <span class="d-none d-sm-inline ml-1" i18n>Neue PIN</span>
                            </button>
                            <button type="button"
                                    class="btn btn-primary btn-sm mr-2"
                                    i18n-title
                                    title="Ergebnis anzeigen"
                                    (click)="openTask(i)"
                                    *ngIf="task.status === 'submitted'">
                                <svg width="1em"
                                     height="1em"
                                     viewBox="0 0 16 16"
                                     class="bi bi-binoculars-fill"
                                     fill="currentColor"
                                     xmlns="http://www.w3.org/2000/svg"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path
                                        d="M4.5 1A1.5 1.5 0 0 0 3 2.5V3h4v-.5A1.5 1.5 0 0 0 5.5 1h-1zM7 4v1h2V4h4v.882a.5.5 0 0 0 .276.447l.895.447A1.5 1.5 0 0 1 15 7.118V13H9v-1.5a.5.5 0 0 1 .146-.354l.854-.853V9.5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v.793l.854.853A.5.5 0 0 1 7 11.5V13H1V7.118a1.5 1.5 0 0 1 .83-1.342l.894-.447A.5.5 0 0 0 3 4.882V4h4zM1 14v.5A1.5 1.5 0 0 0 2.5 16h3A1.5 1.5 0 0 0 7 14.5V14H1zm8 0v.5a1.5 1.5 0 0 0 1.5 1.5h3a1.5 1.5 0 0 0 1.5-1.5V14H9zm4-11H9v-.5A1.5 1.5 0 0 1 10.5 1h1A1.5 1.5 0 0 1 13 2.5V3z" />
                                </svg>
                                <span class="d-none d-sm-inline ml-1" i18n>Ergebnis</span>
                            </button>
                            <button type="button"
                                    class="btn btn-primary btn-sm mr-2"
                                    i18n-title
                                    title="Antwort abschließen"
                                    (click)="completeTask(i)"
                                    *ngIf="task.status !== 'completed' && auth.IsAuthorized(['admin', 'manager', 'editor'], form.owner.id, form.groups)">
                                <svg width="1em"
                                     height="1em"
                                     viewBox="0 0 16 16"
                                     class="bi bi-arrow-clockwise"
                                     fill="currentColor"
                                     xmlns="http://www.w3.org/2000/svg"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path fill-rule="evenodd" d="M15.354 2.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L8 9.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                                    <path fill-rule="evenodd" d="M8 2.5A5.5 5.5 0 1 0 13.5 8a.5.5 0 0 1 1 0 6.5 6.5 0 1 1-3.25-5.63.5.5 0 1 1-.5.865A5.472 5.472 0 0 0 8 2.5z"/>
                                </svg>
                                <span class="d-none d-sm-inline ml-1" i18n>Abschließen</span>
                            </button>
                            <button type="button"
                                    class="btn btn-danger btn-sm mr-2"
                                    i18n-title
                                    title="Antwort löschen"
                                    (click)="deleteTask(i)"
                                    *ngIf="auth.IsAuthorized(['admin', 'manager'], form.owner.id, form.groups)">
                                <svg width="1em"
                                     height="1em"
                                     viewBox="0 0 16 16"
                                     class="bi bi-trash-fill"
                                     fill="currentColor"
                                     xmlns="http://www.w3.org/2000/svg"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path fill-rule="evenodd"
                                        d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5a.5.5 0 0 0-1 0v7a.5.5 0 0 0 1 0v-7z" />
                                </svg>
                                <span class="d-none d-sm-inline ml-1" i18n>Löschen</span>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
            <span class="m-3" *ngIf="!tasks.length" i18n>Keine Antworten vorhanden</span>
        </div>

        <div class="card-footer">
            <button type="button"
                    class="btn btn-success btn-sm mr-2"
                    i18n-title
                    title="Neue PIN erstellen"
                    (click)="maketask.open()"
                    *ngIf="form.status === 'published' && form.access !== 'public' && auth.IsAuthorized(['admin', 'manager', 'editor'], form.owner.id, form.groups)">
                <svg width="1em"
                     height="1em"
                     viewBox="0 0 16 16"
                     class="bi bi-plus"
                     fill="currentColor"
                     xmlns="http://www.w3.org/2000/svg"
                     focusable="false"
                     aria-hidden="true">
                    <path fill-rule="evenodd"
                          d="M8 3.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H4a.5.5 0 0 1 0-1h3.5V4a.5.5 0 0 1 .5-.5z" />
                    <path fill-rule="evenodd"
                        d="M8 3.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H4a.5.5 0 0 1 0-1h3.5V4a.5.5 0 0 1 .5-.5z" />
                    <path fill-rule="evenodd" d="M7.5 8a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1H8.5V12a.5.5 0 0 1-1 0V8z" />
                </svg>
                <span class="d-none d-sm-inline ml-1" i18n>Neue PIN erstellen</span>
            </button>

            <button *ngIf="auth.IsAuthorized(['admin', 'manager', 'editor'], form.owner.id, form.groups)"
                    type="button"
                    class="btn btn-primary btn-sm mr-2"
                    i18n-title
                    title="Ergebnisse als CSV herunterladen"
                    (click)="getCSV()">
                <svg width="1em"
                     height="1em"
                     viewBox="0 0 16 16"
                     class="bi bi-cloud-arrow-down"
                     fill="currentColor"
                     xmlns="http://www.w3.org/2000/svg"
                     focusable="false"
                     aria-hidden="true">
                    <path fill-rule="evenodd"
                        d="M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z" />
                    <path fill-rule="evenodd"
                        d="M7.646 10.854a.5.5 0 0 0 .708 0l2-2a.5.5 0 0 0-.708-.708L8.5 9.293V5.5a.5.5 0 0 0-1 0v3.793L6.354 8.146a.5.5 0 1 0-.708.708l2 2z" />
                </svg>
                <span class="d-none d-sm-inline ml-1" i18n>Ergebnisse (CSV)</span>
            </button>

            <!-- Tasks Pagination -->
            <div class="float-lg-right mt-2 mt-lg-0">
                <div class="form-inline">
                    <div class="form-group m-0 mr-2">
                        <select class="custom-select"
                                (change)="taskPerPage = $event.target.value; updateTasks()">
                            <option *ngFor=" let size of taskPageSizes ">
                                {{ size }}
                            </option>
                        </select>
                    </div>
                    <pagination #pagination [boundaryLinks]="true" [itemsPerPage]="taskPerPage" [maxSize]="10" [totalItems]="taskTotal" (pageChanged)="taskPage = $event.page; this.updateTasks()" previousText="&lsaquo;" nextText="&rsaquo;" firstText="&laquo;" lastText="&raquo;">
                    </pagination>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- new task modal -->
<power-forms-details-maketask #maketask (out)="createTaskEvent($event)"></power-forms-details-maketask>

<!-- publish modal -->
<power-forms-details-publish #publish (out)="publishFormEvent($event)"></power-forms-details-publish>

<!-- comment modal -->
<power-forms-details-comment #comment (out)="commentTaskEvent($event)"></power-forms-details-comment>

<!-- preview modal -->
<power-forms-surveyjs-preview *ngIf="form && form.content" [form]="form.content" #preview>
</power-forms-surveyjs-preview>

<!-- share form modal -->
<power-forms-details-settings #settings [availableTags]="availableTags" [availableGroups]="availableGroups"
                              [availableUsers]="availableUsers" (out)="updateFormEvent($event)"></power-forms-details-settings>
